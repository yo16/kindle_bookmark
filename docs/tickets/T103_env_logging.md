# T103: 環境変数とログ設定

## 📋 基本情報
- **チケットID**: T103
- **タイトル**: 環境変数とログ設定
- **優先度**: High
- **見積もり**: 0.5日（4時間）
- **担当**: Backend
- **ステータス**: TODO

## 🎯 概要
環境変数管理とWinstonを使用したログシステムを実装し、アプリケーションの設定と監視基盤を整備する。

## 📝 詳細説明
### 実装内容
1. **環境変数設定**
   ```typescript
   // .env, .env.example
   PORT=3001
   NODE_ENV=development
   DATABASE_PATH=./data/app.db
   LOG_LEVEL=info
   LOG_FILE_PATH=./logs/app.log
   ```

2. **環境変数検証**
   ```typescript
   // src/config/env.ts
   - 必須環境変数のチェック
   - デフォルト値設定
   - 型安全な環境変数アクセス
   ```

3. **Winstonログ設定**
   ```typescript
   // src/utils/logger.ts
   - ログレベル設定（error, warn, info, debug）
   - ファイル出力とコンソール出力
   - ログローテーション
   - 日本語メッセージ対応
   ```

4. **ログフォーマット**
   - タイムスタンプ付与
   - JSON形式での構造化ログ
   - エラースタックトレース出力
   - リクエストID付与（将来対応）

## ✅ 完了条件
- [ ] .env、.env.example作成
- [ ] 環境変数検証機能実装
- [ ] Winstonログ設定完了
- [ ] ログファイル出力確認
- [ ] 各ログレベルでの出力テスト

## 🔗 依存関係
- **前提条件**: T101（Express基本サーバー）
- **後続タスク**: T104（エラーハンドリング）、全ての機能実装

## 🧪 検証方法
```bash
cd src/server
# 環境変数テスト
npm run dev
# ログ出力テスト
npm test -- logger.test.ts
# ログファイル確認
ls -la logs/
```

## 📚 参考資料
- Winston公式ドキュメント
- Node.js環境変数ベストプラクティス
- CLAUDE.md開発ガイドライン

## 💡 実装ヒント
1. 本番環境では機密情報をログに出力しない
2. ログローテーションでディスク使用量管理
3. 環境別設定の分離
4. 日本語エラーメッセージでユーザビリティ向上

## ⚠️ 注意事項
- .envファイルはGitにコミットしない
- ログファイルの権限設定
- ディスク容量不足対策
- 機密情報の不用意な出力防止